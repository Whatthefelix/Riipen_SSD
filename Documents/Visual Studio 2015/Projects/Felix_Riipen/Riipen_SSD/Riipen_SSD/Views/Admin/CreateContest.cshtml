
@{
    ViewBag.Title = "CreateContest";
}

@section Scripts{
    <style>
        #excelPreview {
            display: none;
        }
    </style>
    <script>
        i = 0;
        $(function () {
            $('.multi-field-wrapper').each(function () {

                var $wrapper = $('.multi-fields', this);

                $(".add-criteria", $(this)).click(function (e) {
                    i++;
                    var criteria = $('.multi-field:first-child', $wrapper).clone(true);
                    criteria.appendTo($wrapper).find('input').val('').focus();
                });


                $('.multi-field .remove-field', $wrapper).click(function () {
                    if ($('.multi-field', $wrapper).length > 1)
                        $(this).parent('.multi-field').remove();
                });
            });
            k = 0;
            $(function () {
                $('.multi-field-wrapper').each(function () {
                    var $judgeWrapper = $('.multi-fields', this);

                    $(".add-judge", $(this)).click(function (e) {
                        k++;
                        var judge = $('.multi-field:first-child', $judgeWrapper).clone(true);
                        judge.appendTo($judgeWrapper).find('input').val('').focus();
                    });

                    
                     $('.multi-field .remove-field', $judgeWrapper).click(function () {
                         if ($('.multi-field', $judgeWrapper).length > 1)
                             $(this).parent('.multi-field').remove();     
                         k--;
                     });
                 });
                });


                $('#uploadExcel').click(function () {
                    $('#excelPreview').show();
                });

                $("#ContestForm").submit(function (e) {
                    e.preventDefault();
                    var judgeListItems = $('.judge-list-item');
                    $(judgeListItems).each(function (index, element) {
                        var children = $(element).children();
                        $(children[0]).attr('name', 'judges[' + index + '].firstname');
                        $(children[1]).attr('name', 'judges[' + index + '].lastname');
                        $(children[2]).attr('name', 'judges[' + index + '].email');    
                    })
                    var criteriaListItems = $('.criteria-list-item');
                    $(criteriaListItems).each(function (index, element) {
                        var children = $(element).children();
                        $(children[0]).attr('name', 'criteria[' + index + '].name');
                        $(children[1]).attr('name', 'criteria[' + index + '].description');   
                    });
                    this.submit();
                });

                

            })
       
    </script>
}
<h2>Add Contest</h2>
<form id="ContestForm" role="form" method="post">
    <div class="form-group">
        <div class="contestName">
            <label for="contestName">Contest Name</label>
            <input type="text" name="ContestName" id="contestName" />
        </div>
        <div class="date">
            <label for="date">Date</label>
            <input type="date" name="Date" id="date" />
        </div>
        <div class="location">
            <label for="location">Location</label>
            <input type="text" name="Location" id="location" />
        </div>
        <div class="multi-field-wrapper">
            <div class="multi-fields" id="criteria-list">
                <div class="multi-field criteria-list-item">
                    <input type="text" name="criteria[0].name" placeholder="New Criteria" />
                    <input type="text" name="criteria[0].description" placeholder="Criteria Description" />
                    <button type="button" class="remove-field"> Remove </button>
                </div>
            </div>
            <button type="button" class="add-criteria"> Add Criteria</button>
        </div>
        <div class="multi-field-wrapper">
            <div class="multi-fields">
                <div class="multi-field judge-list-item">
                    <input type="text" name="judges[0].firstname" placeholder="Judge First Name" />
                    <input type="text" name="judges[0].lastname" placeholder="Judge Last Name" />
                    <input type="text" name="judges[0].email" placeholder="Judge Email" />
                    <button type="button" class="remove-field">Remove</button>
                </div>
            </div>
            <button type="button" class="add-judge"> Add Judge</button>
        </div>

        <p>Add teams and judges</p>
        <button type="button" class="uploadExcel" id="uploadExcel"> Upload</button>
        <div id="excelPreview">
            <table class="table table-striped">
                <caption>Judges</caption>
                <tr>
                    <td>Name</td>
                    <td>Email</td>
                </tr>
                <tr>
                    <td>Andrew</td>
                    <td>AndrewJudge@judgetruddy.com</td>
                </tr>
            </table>
            <table class="table table-striped">
                <caption>Teams</caption>
                <tr>
                    <td>Team Name</td>
                    <td> Members</td>
                    <td> Email</td>
                </tr>
                <tr>
                    <td>Team Awesome</td>
                    <td>Jack</td>
                    <td>Daniel</td>
                    <td>jd@jd.com</td>
                </tr>
                <tr>
                    <td>Team Awesome</td>
                    <td>Jacob</td>
                    <td>Kenny</td>
                    <td>jdk@jdk.com</td>
                </tr>
                <tr>
                    <td>Team Awesome</td>
                    <td>Joseph</td>
                    <td>Daniel</td>
                    <td>josephd@jd.com</td>
                </tr>
                <tr>
                    <td>Team Awesome</td>
                    <td>Miles</td>
                    <td>McLeod</td>
                    <td>runningMiles@miles.com</td>
                </tr>
            </table>
        </div>
        <button type="submit"> Create Contest</button>
    </div>
</form>
